{% extends 'base.html' %}
{% load static %}

{% block title %}{{ article.title }}{% endblock %}

{% block content %}
    <h1>{{ article.title }}</h1>

    {% if article.header_image %}
        <img src="{{ article.header_image.url }}" alt="{{ article.header_image.url }}" style="width: 100%; height: 300px; object-fit: cover; object-position: middle;">
    {% endif %}

    <p>
        üè∑Ô∏è Category: {{ article.category.name }} |
        üïí Created On: {{ article.created_on }} |
        ‚úÖ Last Updated: {{ article.updated_on }}
    </p>

    <hr>
    <p>{{ article.entry }}</p>

    <p><a href="{% url 'wiki:articles-list' %}">Back to Article List</a>


    <h3>Read More from {{ article.category.name }}</h3>
    <ul>
        {% for related in related_articles %}
            <li><a href="{{ related.get_absolute_url }}">{{ related.title }}</a></li>
        {% empty %}
            <li>No other articles in this category.</li>
        {% endfor %}
    </ul>

    <hr>
    <h3>Leave a Comment:</h3>
    {% if user.is_authenticated %}
        <form method="post">
            {% csrf_token %}
            {{ comment_form }}
            <button type="submit">Post Comment</button>
        </form>
    {% else %}
        <p>You must be logged in.</p>
    {% endif %}

    <hr>
    <h3>Comments</h3>
    {% for comment in comments %}
        <div style="margin-bottom: 1em;">
            <strong>{{ comment.author.name }}</strong> | {{ comment.created_on|date:"M d, Y H:i" }} 
            {% if comment.updated_on != comment.created_on %}
                (Edited: {{ comment.updated_on|date:"M d, Y H:i" }})
            {% endif %}

            <br>
            {{ comment.entry }}
        </div>
    {% empty %}
        <p>No comments yet.</p>
    {% endfor %}
{% endblock %}
